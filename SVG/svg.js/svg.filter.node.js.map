{"version":3,"file":"svg.filter.node.js","sources":["../src/svg.filter.js"],"sourcesContent":["import {\r\n  Array as SVGArray,\r\n  Container,\r\n  Defs,\r\n  Element,\r\n  extend,\r\n  find,\r\n  namespaces as ns,\r\n  nodeOrNew,\r\n  utils,\r\n  wrapWithAttrCheck\r\n} from '@svgdotjs/svg.js'\r\n\r\nexport default class Filter extends Element {\r\n  constructor (node) {\r\n    super(nodeOrNew('filter', node), node)\r\n\r\n    this.$source = 'SourceGraphic'\r\n    this.$sourceAlpha = 'SourceAlpha'\r\n    this.$background = 'BackgroundImage'\r\n    this.$backgroundAlpha = 'BackgroundAlpha'\r\n    this.$fill = 'FillPaint'\r\n    this.$stroke = 'StrokePaint'\r\n    this.$autoSetIn = true\r\n  }\r\n\r\n  put (element, i) {\r\n    element = super.put(element, i)\r\n\r\n    if (!element.attr('in') && this.$autoSetIn) {\r\n      element.attr('in', this.$source)\r\n    }\r\n    if (!element.attr('result')) {\r\n      element.attr('result', element.id())\r\n    }\r\n\r\n    return element\r\n  }\r\n\r\n  // Unmask all masked elements and remove itself\r\n  remove () {\r\n    // unmask all targets\r\n    this.targets().each('unfilter')\r\n\r\n    // remove mask from parent\r\n    return super.remove()\r\n  }\r\n\r\n  targets () {\r\n    return find('svg [filter*=\"' + this.id() + '\"]')\r\n  }\r\n\r\n  toString () {\r\n    return 'url(#' + this.id() + ')'\r\n  }\r\n}\r\n\r\n// Create Effect class\r\nclass Effect extends Element {\r\n  constructor (node) {\r\n    super(node, node)\r\n    this.result(this.id())\r\n  }\n\r\n  in (effect) {\r\n    // Act as getter\r\n    if (effect == null) {\r\n      const _in = this.attr('in')\r\n      const ref = this.parent() && this.parent().find(`[result=\"${_in}\"]`)[0]\r\n      return ref || _in\r\n    }\r\n\r\n    // Avr as setter\r\n    return this.attr('in', effect)\r\n  }\n\r\n  // Named result\r\n  result (result) {\r\n    return this.attr('result', result)\r\n  }\n\r\n  // Stringification\r\n  toString () {\r\n    return this.result()\r\n  }\r\n}\r\n\r\n// This function takes an array with attr keys and sets for every key the\r\n// attribute to the value of one paramater\r\n// getAttrSetter(['a', 'b']) becomes this.attr({a: param1, b: param2})\r\nconst getAttrSetter = (params) => {\r\n  return function (...args) {\r\n    for (let i = params.length; i--;) {\r\n      if (args[i] != null) {\r\n        this.attr(params[i], args[i])\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nconst updateFunctions = {\r\n  blend: getAttrSetter(['in', 'in2', 'mode']),\r\n  // ColorMatrix effect\r\n  colorMatrix: getAttrSetter(['type', 'values']),\r\n  // Composite effect\r\n  composite: getAttrSetter(['in', 'in2', 'operator']),\r\n  // ConvolveMatrix effect\r\n  convolveMatrix: function (matrix) {\r\n    matrix = new SVGArray(matrix).toString()\r\n\r\n    this.attr({\r\n      order: Math.sqrt(matrix.split(' ').length),\r\n      kernelMatrix: matrix\r\n    })\r\n  },\r\n  // DiffuseLighting effect\r\n  diffuseLighting: getAttrSetter(['surfaceScale', 'lightingColor', 'diffuseConstant', 'kernelUnitLength']),\r\n  // DisplacementMap effect\r\n  displacementMap: getAttrSetter(['in', 'in2', 'scale', 'xChannelSelector', 'yChannelSelector']),\r\n  // DropShadow effect\r\n  dropShadow: getAttrSetter(['in', 'dx', 'dy', 'stdDeviation']),\r\n  // Flood effect\r\n  flood: getAttrSetter(['flood-color', 'flood-opacity']),\r\n  // Gaussian Blur effect\r\n  gaussianBlur: function (x = 0, y = x) {\r\n    this.attr('stdDeviation', x + ' ' + y)\r\n  },\r\n  // Image effect\r\n  image: function (src) {\r\n    this.attr('href', src, ns.xlink)\r\n  },\r\n  // Morphology effect\r\n  morphology: getAttrSetter(['operator', 'radius']),\r\n  // Offset effect\r\n  offset: getAttrSetter(['dx', 'dy']),\r\n  // SpecularLighting effect\r\n  specularLighting: getAttrSetter(['surfaceScale', 'lightingColor', 'diffuseConstant', 'specularExponent', 'kernelUnitLength']),\r\n  // Tile effect\r\n  tile: getAttrSetter([]),\r\n  // Turbulence effect\r\n  turbulence: getAttrSetter(['baseFrequency', 'numOctaves', 'seed', 'stitchTiles', 'type'])\r\n}\r\n\r\nconst filterNames = [\r\n  'blend',\r\n  'colorMatrix',\r\n  'componentTransfer',\r\n  'composite',\r\n  'convolveMatrix',\r\n  'diffuseLighting',\r\n  'displacementMap',\r\n  'dropShadow',\r\n  'flood',\r\n  'gaussianBlur',\r\n  'image',\r\n  'merge',\r\n  'morphology',\r\n  'offset',\r\n  'specularLighting',\r\n  'tile',\r\n  'turbulence'\r\n]\r\n\r\n// For every filter create a class\r\nfilterNames.forEach((effect) => {\r\n  const name = utils.capitalize(effect)\r\n  const fn = updateFunctions[effect]\r\n\r\n  Filter[name + 'Effect'] = class extends Effect {\r\n    constructor (node) {\r\n      super(nodeOrNew('fe' + name, node), node)\r\n    }\r\n\r\n    // This function takes all parameters from the factory call\r\n    // and updates the attributes according to the updateFunctions\r\n    update (args) {\r\n      fn.apply(this, args)\r\n      return this\r\n    }\r\n  }\r\n\r\n  // Add factory function to filter\r\n  // Allow to pass a function or object\r\n  // The attr object is catched from \"wrapWithAttrCheck\"\r\n  Filter.prototype[effect] = wrapWithAttrCheck(function (fn, ...args) {\r\n    const effect = new Filter[name + 'Effect']()\r\n\r\n    if (fn == null) return this.put(effect)\r\n\r\n    // For Effects which can take children, a function is allowed\r\n    if (typeof fn === 'function') {\r\n      fn.call(effect, effect)\r\n    } else {\r\n      // In case it is not a function, add it to arguments\r\n      args.unshift(fn)\r\n    }\r\n    return this.put(effect).update(args)\r\n  })\r\n})\r\n\r\n// Correct factories which are not that simple\r\nextend(Filter, {\r\n  merge (arrayOrFn) {\r\n    const node = this.put(new Filter.MergeEffect())\r\n\r\n    // If a function was passed, execute it\r\n    // That makes stuff like this possible:\r\n    // filter.merge((mergeEffect) => mergeEffect.mergeNode(in))\r\n    if (typeof arrayOrFn === 'function') {\r\n      arrayOrFn.call(node, node)\r\n      return node\r\n    }\r\n\r\n    // Check if first child is an array, otherwise use arguments as array\r\n    var children = arrayOrFn instanceof Array ? arrayOrFn : [...arguments]\r\n\r\n    children.forEach((child) => {\r\n      if (child instanceof Filter.MergeNode) {\r\n        node.put(child)\r\n      } else {\r\n        node.mergeNode(child)\r\n      }\r\n    })\r\n\r\n    return node\r\n  },\r\n  componentTransfer (components = {}) {\r\n    const node = this.put(new Filter.ComponentTransferEffect())\r\n\r\n    if (typeof components === 'function') {\r\n      components.call(node, node)\r\n      return node\r\n    }\r\n\r\n    // If no component is set, we use the given object for all components\r\n    if (!components.r && !components.g && !components.b && !components.a) {\r\n      const temp = components\r\n      components = {\r\n        r: temp, g: temp, b: temp, a: temp\r\n      }\r\n    }\r\n\r\n    for (const c in components) {\r\n      // components[c] has to hold an attributes object\r\n      node.add(new Filter['Func' + c.toUpperCase()](components[c]))\r\n    }\r\n\r\n    return node\r\n  }\r\n})\r\n\r\nconst filterChildNodes = [\r\n  'distantLight',\r\n  'pointLight',\r\n  'spotLight',\r\n  'mergeNode',\r\n  'FuncR',\r\n  'FuncG',\r\n  'FuncB',\r\n  'FuncA'\r\n]\r\n\r\nfilterChildNodes.forEach((child) => {\r\n  const name = utils.capitalize(child)\r\n  Filter[name] = class extends Effect {\r\n    constructor (node) {\r\n      super(nodeOrNew('fe' + name, node), node)\r\n    }\r\n  }\r\n})\r\n\r\nconst componentFuncs = [\r\n  'funcR',\r\n  'funcG',\r\n  'funcB',\r\n  'funcA'\r\n]\r\n\r\n// Add an update function for componentTransfer-children\r\ncomponentFuncs.forEach(function (c) {\r\n  const _class = Filter[utils.capitalize(c)]\r\n  const fn = wrapWithAttrCheck(function () {\r\n    return this.put(new _class())\r\n  })\r\n\r\n  Filter.ComponentTransferEffect.prototype[c] = fn\r\n})\r\n\r\nconst lights = [\r\n  'distantLight',\r\n  'pointLight',\r\n  'spotLight'\r\n]\r\n\r\n// Add light sources factories to lightining effects\r\nlights.forEach((light) => {\r\n  const _class = Filter[utils.capitalize(light)]\r\n  const fn = wrapWithAttrCheck(function () {\r\n    return this.put(new _class())\r\n  })\r\n\r\n  Filter.DiffuseLightingEffect.prototype[light] = fn\r\n  Filter.SpecularLightingEffect.prototype[light] = fn\r\n})\r\n\r\nextend(Filter.MergeEffect, {\r\n  mergeNode (_in) {\r\n    return this.put(new Filter.MergeNode()).attr('in', _in)\r\n  }\r\n})\r\n\r\n// add .filter function\r\nextend(Defs, {\r\n  // Define filter\r\n  filter: function (block) {\r\n    var filter = this.put(new Filter())\r\n\r\n    /* invoke passed block */\r\n    if (typeof block === 'function') { block.call(filter, filter) }\r\n\r\n    return filter\r\n  }\r\n})\r\n\r\nextend(Container, {\r\n  // Define filter on defs\r\n  filter: function (block) {\r\n    return this.defs().filter(block)\r\n  }\r\n})\r\n\r\nextend(Element, {\r\n  // Create filter element in defs and store reference\r\n  filterWith: function (block) {\r\n    const filter = block instanceof Filter\r\n      ? block : this.defs().filter(block)\r\n\r\n    return this.attr('filter', filter)\r\n  },\r\n  // Remove filter\r\n  unfilter: function (remove) {\r\n    /* remove filter attribute */\r\n    return this.attr('filter', null)\r\n  },\r\n  filterer () {\r\n    return this.reference('filter')\r\n  }\r\n})\r\n\r\n// chaining\r\nvar chainingEffects = {\r\n  // Blend effect\r\n  blend: function (in2, mode) {\r\n    return this.parent() && this.parent().blend(this, in2, mode) // pass this as the first input\r\n  },\r\n  // ColorMatrix effect\r\n  colorMatrix: function (type, values) {\r\n    return this.parent() && this.parent().colorMatrix(type, values).in(this)\r\n  },\r\n  // ComponentTransfer effect\r\n  componentTransfer: function (components) {\r\n    return this.parent() && this.parent().componentTransfer(components).in(this)\r\n  },\r\n  // Composite effect\r\n  composite: function (in2, operator) {\r\n    return this.parent() && this.parent().composite(this, in2, operator) // pass this as the first input\r\n  },\r\n  // ConvolveMatrix effect\r\n  convolveMatrix: function (matrix) {\r\n    return this.parent() && this.parent().convolveMatrix(matrix).in(this)\r\n  },\r\n  // DiffuseLighting effect\r\n  diffuseLighting: function (surfaceScale, lightingColor, diffuseConstant, kernelUnitLength) {\r\n    return this.parent() && this.parent().diffuseLighting(surfaceScale, diffuseConstant, kernelUnitLength).in(this)\r\n  },\r\n  // DisplacementMap effect\r\n  displacementMap: function (in2, scale, xChannelSelector, yChannelSelector) {\r\n    return this.parent() && this.parent().displacementMap(this, in2, scale, xChannelSelector, yChannelSelector) // pass this as the first input\r\n  },\r\n  // DisplacementMap effect\r\n  dropShadow: function (x, y, stdDeviation) {\r\n    return this.parent() && this.parent().dropShadow(this, x, y, stdDeviation).in(this) // pass this as the first input\r\n  },\r\n  // Flood effect\r\n  flood: function (color, opacity) {\r\n    return this.parent() && this.parent().flood(color, opacity) // this effect dont have inputs\r\n  },\r\n  // Gaussian Blur effect\r\n  gaussianBlur: function (x, y) {\r\n    return this.parent() && this.parent().gaussianBlur(x, y).in(this)\r\n  },\r\n  // Image effect\r\n  image: function (src) {\r\n    return this.parent() && this.parent().image(src) // this effect dont have inputs\r\n  },\r\n  // Merge effect\r\n  merge: function (arg) {\r\n    arg = arg instanceof Array ? arg : [...arg]\r\n    return this.parent() && this.parent().merge(this, ...arg) // pass this as the first argument\r\n  },\r\n  // Morphology effect\r\n  morphology: function (operator, radius) {\r\n    return this.parent() && this.parent().morphology(operator, radius).in(this)\r\n  },\r\n  // Offset effect\r\n  offset: function (dx, dy) {\r\n    return this.parent() && this.parent().offset(dx, dy).in(this)\r\n  },\r\n  // SpecularLighting effect\r\n  specularLighting: function (surfaceScale, lightingColor, diffuseConstant, specularExponent, kernelUnitLength) {\r\n    return this.parent() && this.parent().specularLighting(surfaceScale, diffuseConstant, specularExponent, kernelUnitLength).in(this)\r\n  },\r\n  // Tile effect\r\n  tile: function () {\r\n    return this.parent() && this.parent().tile().in(this)\r\n  },\r\n  // Turbulence effect\r\n  turbulence: function (baseFrequency, numOctaves, seed, stitchTiles, type) {\r\n    return this.parent() && this.parent().turbulence(baseFrequency, numOctaves, seed, stitchTiles, type).in(this)\r\n  }\r\n}\r\n\r\nextend(Effect, chainingEffects)\r\n\r\n// Effect-specific extensions\r\nextend(Filter.MergeEffect, {\r\n  in: function (effect) {\r\n    if (effect instanceof Filter.MergeNode) {\r\n      this.add(effect, 0)\r\n    } else {\r\n      this.add(new Filter.MergeNode().in(effect), 0)\r\n    }\r\n\r\n    return this\r\n  }\r\n})\r\n\r\nextend([Filter.CompositeEffect, Filter.BlendEffect, Filter.DisplacementMapEffect], {\r\n  in2: function (effect) {\r\n    if (effect == null) {\r\n      const in2 = this.attr('in2')\r\n      const ref = this.parent() && this.parent().find(`[result=\"${in2}\"]`)[0]\r\n      return ref || in2\r\n    }\r\n    return this.attr('in2', effect)\r\n  }\r\n})\r\n\r\n// Presets\r\nFilter.filter = {\r\n  sepiatone: [\r\n    0.343, 0.669, 0.119, 0, 0,\r\n    0.249, 0.626, 0.130, 0, 0,\r\n    0.172, 0.334, 0.111, 0, 0,\r\n    0.000, 0.000, 0.000, 1, 0]\r\n}\r\n"],"names":["Filter","Element","constructor","node","nodeOrNew","$source","$sourceAlpha","$background","$backgroundAlpha","$fill","$stroke","$autoSetIn","put","element","i","attr","id","remove","targets","each","find","toString","Effect","result","in","effect","_in","ref","parent","getAttrSetter","params","args","length","updateFunctions","blend","colorMatrix","composite","convolveMatrix","matrix","SVGArray","order","Math","sqrt","split","kernelMatrix","diffuseLighting","displacementMap","dropShadow","flood","gaussianBlur","x","y","image","src","ns","xlink","morphology","offset","specularLighting","tile","turbulence","filterNames","forEach","name","utils","capitalize","fn","update","apply","prototype","wrapWithAttrCheck","call","unshift","extend","merge","arrayOrFn","MergeEffect","children","Array","arguments","child","MergeNode","mergeNode","componentTransfer","components","ComponentTransferEffect","r","g","b","a","temp","c","add","toUpperCase","filterChildNodes","componentFuncs","_class","lights","light","DiffuseLightingEffect","SpecularLightingEffect","Defs","filter","block","Container","defs","filterWith","unfilter","filterer","reference","chainingEffects","in2","mode","type","values","operator","surfaceScale","lightingColor","diffuseConstant","kernelUnitLength","scale","xChannelSelector","yChannelSelector","stdDeviation","color","opacity","arg","radius","dx","dy","specularExponent","baseFrequency","numOctaves","seed","stitchTiles","CompositeEffect","BlendEffect","DisplacementMapEffect","sepiatone"],"mappings":"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"}